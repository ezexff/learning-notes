# MSVC

Процесс трансляции - компиляция и компановка/линковка
* Препроцессор - объединение файлов с текстом программы в единое целое
* Компилятор - создание объектных модулей (.obj файлов) по единицам трансляции (translation units)
* Компоновка (линковка) объектных модулей (.obj файлов) в исполняемый файл (.exe) или в библиотеку (.dll)

Фазы процесса трансляции
* I --- исходный файл поступает на вход препроцессора. Препроцессор делает подстановку содержимого указанных в #include файлов и раскрывает макросы
* II --- препроцессированный файл поступает на вход компилятора и преобразуется в объектный.
* III --- компоновщик связывает объектные файлы и предоставленные статические библиотеки, формируя исполняемую программу

Входы и выходы на этапах процесса трансляции
* Preprocessor: source files (*.c, *.cc, *.cpp, *.cxx) -> preprocessed file (*.i)
* Compiler: preprocessed file (*.i) -> object file (*.o)
* Linker: object file (1 to N) + static libraries (*.lib, *.a) -> executable program

Компилятору не важно какого типа файл, т.к. он лишь читает его содержимое. Например, можно скомпилировать файл .cpp с текстом программы на C указав параметр /TC и наоборот /TP. Компилятор, при добавлении файлов при помощи #include, всего-лишь копирует их содержимое и объединяет в один текст программы. Например, в main.c может быть 10/100/1000 и более инклюдов, компилятор их просто объединит в одно целое

Address space layout randomization (ASLR) - технология, применяемая в операционных системах, при использовании которой случайным образом изменяется расположение в адресном пространстве процесса важных структур данных, а именно образов исполняемого файла, подгружаемых библиотек, кучи и стека

Application binary interface (ABI) или же двоичный (бинарный) интерфейс приложений - набор соглашений для доступа приложения к операционной системе и другим низкоуровневым сервисам, спроектированный для переносимости исполняемого кода между машинами, имеющими совместимые ABI

Dynamic linker - это часть операционной системы, которая загружает и связывает общие библиотеки, необходимые для исполняемого файла, когда он выполняется, путем копирования содержимого библиотек из постоянного хранилища в ОЗУ, заполнения таблиц переходов и перемещения указателей

Как Windows понимает, что перед ним программа, которую нужно запустить, а не текстовый файл? Чтобы это понять мы можем взглянуть на содержимое .exe файла через HxD-editor. В начале .exe файла имеется MZ преамбула DOS исполняемого файла, а далее сообщение об ошибке "This program cannot be run in DOS mode". Эту заглушку добавляет компилятор для совместимости. Сама же программа начинается с байтов 50 45, т.е с сигнатуры PE (декодированный текст Windows ANSI) или же Portable Executable. По этой сигнатуре Windows понимает, что перед ней исполняемый файл

### Disable optmization

```C
#pragma optimize( "", off )
/* unoptimized code section */
#pragma optimize( "", on )
```
